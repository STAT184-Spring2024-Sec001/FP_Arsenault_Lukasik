---
title: "Final Project"
author: "Jacob Lukasik and Will Arsenault"
date: "2024-04-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## STAT184 Final Project: Analyzing Data From the FIA Formula 1 World Championship

For this project, we have found a very vast dataset regarding the FIA Formula 1 World Championship which contains Driver and Constructor information as well as, lap times, race results, and pit stop data from the inaugural season of the FIA Formula 1 World Championship, 1950, all the way up to the end of the 2023 season. With this dataset, we are striving to find and assess any connections that may be found that can show the relationships lap times and race success, along with how well consistent lap times lead to better team performance. 

## Step 1: Loading Data and Necessary Libraries

```{r message=FALSE}
library(ggplot2)
library(dplyr)
library(janitor)
library(knitr)
```


```{r}
circuits <- read.csv('circuits.csv', header = TRUE)
const_results <- read.csv('constructor_results.csv', header = TRUE)
const_standings <- read.csv('constructor_standings.csv', header = TRUE)
constructors <- read.csv('constructors.csv', header = TRUE)
driver_standings <- read.csv('driver_standings.csv', header = TRUE)
drivers <- read.csv('drivers.csv', header = TRUE)
lap_times <- read.csv('lap_times.csv', header = TRUE)
pit_stops <- read.csv('pit_stops.csv', header = TRUE)
qualifying <- read.csv('qualifying.csv', header = TRUE)
races <- read.csv('races.csv', header = TRUE)
results <- read.csv('results.csv', header = TRUE)
seasons <- read.csv('seasons.csv', header = TRUE)
status <- read.csv('status.csv', header = TRUE)
```


The first insight into lap times we planned on finding was how lap times have gotten faster over the long history of Formula 1. To investigate this, we will first filter our data so that we have the fastest lap time from every season of F1 at Monza. We have keened in on this circuit in particular because it has been a mainstay in nearly every Formula 1 season, only not having a race held there in the 1980 season. Once we have a data frame containing just information regarding the fastest lap time at Monza every season, we can make a line graph and look for trends.


```{r}
simplified_races <- races %>% # simplifying the 'races' table for use later on
  select(raceId, year, circuitId, name)
only_monza <- races %>% # first we will only find races at monza from the 'races' data frame, then we will use those races to find the fastest lap times in 'results'
  filter(circuitId == 14) # inspecting the 'circuits' data frame tells us that Monza's circuitId is 14
monza_fastest_laps <- results %>% # now we will make a table with just the fastest lap time from every year
  filter(raceId %in% only_monza$raceId) %>% # making sure we only look at races at Monza
  filter(!is.na(fastestLapTime) & fastestLapTime != '\\N') %>% # make sure no N/A values are present
  group_by(raceId) %>% 
  summarize(fastestLapTime = min(fastestLapTime, na.rm = TRUE)) %>% # only contain the fastest lap time from each race
  left_join(simplified_races, by = "raceId") # join with the 'simplified_races' table to see what year the race was

ggplot(monza_fastest_laps, aes(x = year, y = fastestLapTime)) +
  geom_point(color = "blue", size = 3) +  # scatter plot with blue points
  labs(x = "Year", y = "Fastest Lap Time") + # labels for axes
  ggtitle("Fastest Lap Time by Year") + # main title
  theme_minimal() +  # minimalist theme
  theme(axis.text = element_text(size = 16), # axis text size
        axis.title = element_text(size = 16), # axis title size
        plot.title = element_text(size = 16, face = "bold")) # plot title size and style
```




